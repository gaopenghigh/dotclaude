// Query the first RestartNode/ReimageNode alerts on Jan 14
let qFrom = datetime("2026-01-14T12:20:00Z");
let qTo = datetime("2026-01-14T13:00:00Z");
let qCCP = "67e347c35b89890001621aeb";
CPRemediatorLogs
| where PreciseTimeStamp between (qFrom .. qTo)
| where namespace == qCCP
| extend logPreciseTime = todatetime(logPreciseTime)
| extend alert = tostring(alert)
| extend msg = tostring(msg)
| where alert in ("RestartNode", "ReimageNode", "RedeployNode") or msg has "Restart" or msg has "Reimage" or msg has "Redeploy"
| project logPreciseTime, alert, msg
| distinct logPreciseTime, alert, msg
| order by logPreciseTime asc
